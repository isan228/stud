<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title><%= typeof title !== 'undefined' ? title : 'Платформа для студентов' %></title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/custom-colors.css">
    <script>
    // Немедленная защита - выполняется до загрузки DOM
    (function() {
        'use strict';
        
    // Все блокировки копирования удалены
    })();
    
    // Управление размером шрифта
    (function() {
        const fontSizeKey = 'siteFontSize';
        const defaultFontSize = 16; // базовый размер в px
        
        // Загружаем сохраненный размер шрифта
        function loadFontSize() {
            const savedSize = localStorage.getItem(fontSizeKey);
            if (savedSize) {
                document.documentElement.style.fontSize = savedSize + 'px';
            } else {
                document.documentElement.style.fontSize = defaultFontSize + 'px';
            }
        }
        
        // Увеличить шрифт
        window.increaseFontSize = function() {
            const currentSize = parseFloat(getComputedStyle(document.documentElement).fontSize);
            const newSize = Math.min(currentSize + 2, 24); // максимум 24px
            document.documentElement.style.fontSize = newSize + 'px';
            localStorage.setItem(fontSizeKey, newSize);
        };
        
        // Уменьшить шрифт
        window.decreaseFontSize = function() {
            const currentSize = parseFloat(getComputedStyle(document.documentElement).fontSize);
            const newSize = Math.max(currentSize - 2, 12); // минимум 12px
            document.documentElement.style.fontSize = newSize + 'px';
            localStorage.setItem(fontSizeKey, newSize);
        };
        
        // Сбросить размер шрифта
        window.resetFontSize = function() {
            document.documentElement.style.fontSize = defaultFontSize + 'px';
            localStorage.setItem(fontSizeKey, defaultFontSize);
        };
        
        // Загружаем размер при загрузке страницы
        loadFontSize();
    })();
    </script>
    <style>
    /* КРИТИЧЕСКИ ВАЖНО: Навбар должен быть цветным - самое первое правило */
    nav.navbar {
        background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #a855f7 100%) !important;
        background-color: #6366f1 !important;
        background-image: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #a855f7 100%) !important;
    }
    
    /* КРИТИЧЕСКИ ВАЖНО: Hero-section должен быть цветным с белым текстом */
    .hero-section {
        background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #ec4899 100%) !important;
        background-image: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #ec4899 100%) !important;
        background-color: #6366f1 !important;
    }
    
    /* Защита от перекрытия белым фоном */
    .hero-section * {
        background-color: transparent !important;
        background: transparent !important;
    }
    
    .hero-section .container,
    .hero-section .hero-content {
        background-color: transparent !important;
        background: transparent !important;
    }
    
    .hero-section *,
    .hero-content * {
        color: #ffffff !important;
    }
    
    .hero-section h1,
    .hero-section h2,
    .hero-section h3,
    .hero-section h4,
    .hero-section h5,
    .hero-section h6,
    .hero-section p,
    .hero-section span,
    .hero-section div,
    .hero-section strong,
    .hero-content h1,
    .hero-content h2,
    .hero-content h3,
    .hero-content h4,
    .hero-content h5,
    .hero-content h6,
    .hero-content p,
    .hero-content span,
    .hero-content div,
    .hero-content strong {
        color: #ffffff !important;
    }
    
    /* Блокировки копирования удалены - пользователи могут свободно копировать текст */
    
    /* Навбар должен оставаться цветным - максимальный приоритет */
    nav.navbar, 
    nav.navbar.navbar-dark, 
    nav.navbar.bg-primary, 
    nav.navbar.navbar-dark.bg-primary,
    body nav.navbar,
    body nav.navbar.navbar-dark,
    body nav.navbar.bg-primary,
    body nav.navbar.navbar-dark.bg-primary,
    .navbar, 
    .navbar-dark, 
    .navbar.bg-primary, 
    .navbar-dark.bg-primary {
        background-color: #6366f1 !important;
        background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #a855f7 100%) !important;
        background-image: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #a855f7 100%) !important;
    }
    
    /* Защита от перекрытия белым фоном */
    nav.navbar *,
    nav.navbar.navbar-dark *,
    nav.navbar.bg-primary *,
    nav.navbar.navbar-dark.bg-primary * {
        background-color: transparent !important;
        background: transparent !important;
    }
    
    nav.navbar .container,
    nav.navbar .navbar-nav,
    nav.navbar .navbar-collapse {
        background-color: transparent !important;
        background: transparent !important;
    }
    
    /* Текст в навбаре должен быть белым и видимым - максимальная специфичность */
    nav.navbar .navbar-brand,
    nav.navbar .nav-link,
    nav.navbar .navbar-nav .nav-link,
    nav.navbar .navbar-nav .nav-item .nav-link,
    .navbar-dark .navbar-brand,
    .navbar-dark .nav-link,
    .navbar-dark .navbar-nav .nav-link,
    .navbar-dark .navbar-nav .nav-item .nav-link,
    .navbar.bg-primary .navbar-brand,
    .navbar.bg-primary .nav-link,
    .navbar.bg-primary .navbar-nav .nav-link,
    .navbar.bg-primary .navbar-nav .nav-item .nav-link,
    .navbar-dark.bg-primary .navbar-brand,
    .navbar-dark.bg-primary .nav-link,
    .navbar-dark.bg-primary .navbar-nav .nav-link,
    .navbar-dark.bg-primary .navbar-nav .nav-item .nav-link {
        color: #ffffff !important;
    }
    
    /* Иконки в навбаре тоже белые */
    nav.navbar .nav-link i,
    nav.navbar .navbar-brand i,
    .navbar-dark .nav-link i,
    .navbar-dark .navbar-brand i,
    .navbar.bg-primary .nav-link i,
    .navbar.bg-primary .navbar-brand i {
        color: #ffffff !important;
    }
    
    /* Ховер эффекты */
    nav.navbar .navbar-brand:hover,
    nav.navbar .nav-link:hover,
    nav.navbar .navbar-nav .nav-link:hover,
    .navbar-dark .navbar-brand:hover,
    .navbar-dark .nav-link:hover,
    .navbar-dark .navbar-nav .nav-link:hover,
    .navbar.bg-primary .navbar-brand:hover,
    .navbar.bg-primary .nav-link:hover,
    .navbar.bg-primary .navbar-nav .nav-link:hover {
        color: rgba(255, 255, 255, 0.9) !important;
    }
    
    /* Кнопки в навбаре */
    .navbar-dark .btn-outline-light,
    .navbar.bg-primary .btn-outline-light {
        color: #ffffff !important;
        border-color: #ffffff !important;
    }
    
    .navbar-dark .btn-outline-light:hover,
    .navbar.bg-primary .btn-outline-light:hover {
        background-color: rgba(255, 255, 255, 0.2) !important;
        color: #ffffff !important;
    }
    
    /* Иконка бургер-меню */
    .navbar-dark .navbar-toggler-icon,
    .navbar.bg-primary .navbar-toggler-icon {
        background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%28255, 255, 255, 1%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e") !important;
    }
    
    .navbar-dark .navbar-toggler,
    .navbar.bg-primary .navbar-toggler {
        border-color: rgba(255, 255, 255, 0.3) !important;
    }
    
    /* Модальные окна - белый фон и темный текст */
    .modal-content, .modal-body {
        background-color: #ffffff !important;
        color: #212529 !important;
    }
    
    .modal-header {
        background-color: #ffffff !important;
        color: #212529 !important;
    }
    
    .modal-header.bg-primary {
        background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #a855f7 100%) !important;
        color: #ffffff !important;
    }
    
    .modal-title {
        color: inherit !important;
    }
    
    /* Алерты - правильные цвета */
    .alert {
        background-color: #ffffff !important;
        color: #212529 !important;
    }
    
    .alert-info {
        background-color: #d1ecf1 !important;
        color: #0c5460 !important;
    }
    
    .alert-success {
        background-color: #d4edda !important;
        color: #155724 !important;
    }
    
    .alert-warning {
        background-color: #fff3cd !important;
        color: #856404 !important;
    }
    
    .alert-danger {
        background-color: #f8d7da !important;
        color: #721c24 !important;
    }
    
    /* Основной текст */
    body, main, .container, .card, .card-body {
        color: #212529 !important;
    }
    
    h1, h2, h3, h4, h5, h6, p, span, div, li {
        color: #212529 !important;
    }
    
    /* Исключения для элементов с белым текстом */
    .text-white, .text-white *,
    .hero-section, .hero-section *,
    .hero-content, .hero-content *,
    .bg-gradient-primary, .bg-gradient-primary *,
    .card.bg-gradient-primary, .card.bg-gradient-primary * {
        color: #ffffff !important;
    }
    
    /* Карточки - темный текст */
    .card,
    .card-body,
    .card-header,
    .card-title,
    .card-text {
        color: #212529 !important;
    }
    
    .card h1,
    .card h2,
    .card h3,
    .card h4,
    .card h5,
    .card h6,
    .card p,
    .card span,
    .card li {
        color: #212529 !important;
    }
    
    /* text-muted */
    .text-muted {
        color: #6c757d !important;
    }
    
    /* Исключение для hero-section заголовков */
    .hero-section h1,
    .hero-section h2,
    .hero-section h3,
    .hero-section h4,
    .hero-section h5,
    .hero-section h6 {
        color: #ffffff !important;
    }
    /* Дополнительная защита - все элементы навбара должны быть видны */
    nav.navbar * {
        color: inherit !important;
    }
    
    nav.navbar a,
    nav.navbar .navbar-brand,
    nav.navbar .nav-link {
        opacity: 1 !important;
        visibility: visible !important;
        display: block !important;
    }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary" style="background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #a855f7 100%) !important; background-color: #6366f1 !important; background-image: linear-gradient(135deg, #6366f1 0%, #8b5cf6 50%, #a855f7 100%) !important;">
        <div class="container">
            <a class="navbar-brand" href="/" style="color: #ffffff !important;">Сайт для студентов</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto align-items-center">
                    <!-- Управление размером шрифта -->
                    <li class="nav-item me-3">
                        <div class="btn-group" role="group" aria-label="Размер шрифта">
                            <button type="button" class="btn btn-sm btn-outline-light" onclick="decreaseFontSize()" title="Уменьшить шрифт">
                                <i class="bi bi-dash-lg"></i> A-
                            </button>
                            <button type="button" class="btn btn-sm btn-outline-light" onclick="resetFontSize()" title="Сбросить размер">
                                <i class="bi bi-text-center"></i> A
                            </button>
                            <button type="button" class="btn btn-sm btn-outline-light" onclick="increaseFontSize()" title="Увеличить шрифт">
                                <i class="bi bi-plus-lg"></i> A+
                            </button>
                        </div>
                    </li>
                    <% if (typeof user !== 'undefined' && user) { %>
                        <% if (user.isAdmin) { %>
                            <li class="nav-item">
                                <a class="nav-link" href="/admin" style="color: #ffffff !important;">
                                    <i class="bi bi-shield-check" style="color: #ffffff !important;"></i> Админка
                                </a>
                            </li>
                        <% } %>
                        <li class="nav-item">
                            <a class="nav-link" href="/profile" style="color: #ffffff !important;">Личный кабинет</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/tests/statistics" style="color: #ffffff !important;">Статистика</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/tests/emulator" style="color: #ffffff !important;">Эмулятор</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/tests/favorites" style="color: #ffffff !important;">
                                <i class="bi bi-star-fill" style="color: #ffffff !important;"></i> Избранные
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/subscription" style="color: #ffffff !important;">Подписка</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/referral" style="color: #ffffff !important;">
                                <i class="bi bi-gift" style="color: #ffffff !important;"></i> Реферальная программа
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/help" style="color: #ffffff !important;">Помощь</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/auth/logout" style="color: #ffffff !important;">Выход</a>
                        </li>
                    <% } else { %>
                        <li class="nav-item">
                            <a class="nav-link" href="/auth/login" style="color: #ffffff !important;">Вход</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/subscription" style="color: #ffffff !important;">Подписка</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="/help" style="color: #ffffff !important;">Помощь</a>
                        </li>
                    <% } %>
                </ul>
            </div>
        </div>
    </nav>

    <main class="container my-4">

